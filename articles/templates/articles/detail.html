{% extends 'template_base.html' %}

{% load static %}

{% block title %}Apprend-elec{% endblock %}

{% block contenu %}
<div class="masthead-lumiere-home col-md-10">
    {% for article in articles %}
    <div class="container-home">
        <div class="container">
            <div class="row h-100 align-items-center justify-content-center text-center">
                {% if article.titre_page == "" %}
                {% else %}
                <div class="col-lg-12 align-self-end">
                    <h1 class="text-uppercase font-weight-bold title_orange">{{ article.titre_page }}</h1>
                    <hr class="divider my-4" />
                </div>
                {% endif %}

                {% if article.sous_titre_page == "" %}
                {% else %}
                <h3 class="text-center mt-5 text-muted">
                    {{ article.sous_titre_page }}
                </h3>
                {% endif %}
            </div>
        </div> 
    </div>
    {% endfor %}

    {% if user.is_superuser %}
    <a href="{% url 'add_articles' sous_category_id=sous_category.id %}" class="nav-link js-scroll-trigger">
        <button type="button" class="btn btn-primary">Ajouter un article sur {{ sous_category.name }}</button>
    </a>
    {% endif %}

    <div class="container my-auto">
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
    </div>
    
    <div class="col-lg-12 text-center">
        {% for article in articles %}
            <div class="container-home">
                <div class="col-lg-6">
                    <h4 class="text-left mt-5 title_orange">
                        {{ article.titres_articles }}
                    </h4>
                    <p class="font-weight-bold text-left text-muted">
                        {{ article.contenu }} contenu
                        <br>

                        <div class="text-muted text-right">
                            Ajouter le {{ article.date_added }}
                        </div>

                    </p>
                </div>

                <p class="font-weight-bold text-muted img_ampoule col-lg-6">
                    <img src="/media/{{ article.image_path }}" class="img_ampoule">
                </p>

            </div>
        {% endfor %}
    </div>
    <div class="col-lg-12">
        <h3 class="text-center mt-2 title_orange">
            Commentaire
        </h3>
        <hr class="divider my-4" />
        {% if not comments.all %}
            <p class="text-muted">Il n'y a pas encore de commentaire..</p>

        {% else %}

            {% for comment in comments.all %}
            <div class="mt-3">
                <div class="card border p-2 ">
                    <h5 class="text-muted">{{ comment.name}} - {{ comment.date_added}}</h5>
                    <br/>
                    <p class="text-muted">{{ comment.body }}</p>
                </div>
            </div>
            {% endfor %}

        {% endif %}
        <br/>
        <br/>
    </div>

    <div class="col-lg-12">
        <h3 class="text-center mt-2 title_orange">
            Voulez-vous ajoutez un commentaire ?
        </h3>

        <form method="POST">
            {% csrf_token %}
            <div class="row h-100 align-items-center justify-content-center text-center mt-5">
                <div class="fieldWrapper my-label text-muted text-center col-lg-6" id="name-comment">
                    {% if request.user.is_authenticated %}
                    <p class="">
                    <label for="id_name">Nom d'utilisateur&nbsp;:</label>
                    <input type="text" name="name" class="form-control" required="" value="{{ user.username }}" id="id_name" readonly>
                    </p>

                    <p class="">
                    <label for="id_e_mail">E-mail&nbsp;:</label>
                    <input type="text" name="e_mail" class="form-control" required="" value="{{ user.email }}" id="id_e_mail" readonly>
                    </p>
                    {% else %}
                    <label for="id_name">Nom d'utilisateur&nbsp;:</label>
                    <input type="text" name="name" class="form-control" required="" id="id_name">
                    <label for="id_e_mail">E-mail&nbsp;:</label>
                    <input type="text" name="e_mail" class="form-control" required="" id="id_e_mail">
                    {% endif %}
                    <label for="id_body">Commentaire&nbsp;:</label>
                    <textarea name="body" cols="40" rows="10" class="form-control" required="" id="id_body"></textarea>
                
                    <script src='https://www.google.com/recaptcha/api.js'></script>

                    <div class="row h-100 align-items-center justify-content-center text-center">
                        <div class="g-recaptcha" data-sitekey="public_key_here"></div>
                    </div>
                    <div class="row h-100 align-items-center justify-content-center text-center">
                        <p class="submit">
                        <input type="submit" name="post" class="btn btn-outline-primary mt-3" value="Ajouter le commentaire" />
                        </p>
                    </div>
                </div>
            </div>
        </form> 
    </div>
</div>
{% endblock contenu %}